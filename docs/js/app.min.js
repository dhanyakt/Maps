function initApp(){ko.applyBindings(new ViewModel)}function mapError(){alert("Try again after sometime")}$(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!0,draggable:!0});var map,largeInfowindow,markers=[],locationList=[{title:"Biltmore Estate",address:"1 Lodge St, Asheville, NC 28803",yelpID:"biltmore-estate-asheville",location:{lat:35.567032,lng:-82.544252}},{title:"Carowinds",address:"14523 Carowinds Blvd, Charlotte, NC 28273",yelpID:"carowinds-charlotte-2",location:{lat:35.103236,lng:-80.943737}},{title:"Nascar Hall Of Fame",address:"400 E.M.L.K. Jr Blvd, Charlotte, NC 28202",yelpID:"nascar-hall-of-fame-charlotte",location:{lat:35.221191,lng:-80.843953}},{title:"Clingmans Dome",address:"Great Smoky Mountains National Park, Bryson City, NC 28713",yelpID:"clingmans-dome-uninc-sevier",location:{lat:35.525521,lng:-83.526306}},{title:"Tweetsie Railroad",address:"300 Tweetsie Railroad Ln, Blowing Rock, NC 28605",yelpID:"tweetsie-railroad-blowing-rock",location:{lat:36.170687,lng:-81.648566}},{title:"Chimney Rock",address:"431 Main St, Chimney Rock, NC 28720",yelpID:"chimney-rock-state-park-chimney-rock",location:{lat:35.43984,lng:-82.249053}}],Locations=function(a){this.title=a.title,this.address=a.address,this.location=a.location},ViewModel=function(){function a(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:35.759573,lng:-79.0193},zoom:8});var a=new google.maps.LatLngBounds;largeInfowindow=new google.maps.InfoWindow({contentString:null});for(var c=0;c<this.locationList.length;c++){var d=this.locationList[c].location,e=this.locationList[c].title,f=this.locationList[c].address,g=this.locationList[c].yelpID;this.marker=new google.maps.Marker({map:map,position:d,title:e,address:f,animation:google.maps.Animation.DROP,id:g}),this.locationList[c].marker=this.marker,marker.addListener("click",function(){b(this,largeInfowindow,!0)}),markers.push(marker),a.extend(markers[c].position)}map.fitBounds(a),window.onresize=function(){map.fitBounds(a)}}function b(a,b,c){function d(a){setTimeout(function(){a.setAnimation(null)},3e3)}function e(){return Math.floor(1e12*Math.random()).toString()}b.marker=a,c&&(a.setAnimation(google.maps.Animation.BOUNCE),d(a));const f="jWmZkyFrOCA2QNJMoOpNYg",g="WlVkulucchfYwOw-8kHqDStncgDQew0T",h="12Ay90fFF1Z_kRlSaDrIZQC-ypo",i="kOePxoen2dhPK26lMFgtO15hmno";var j="https://api.yelp.com/v2/business/"+a.id,k={oauth_consumer_key:f,oauth_token:g,oauth_nonce:e(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",term:a.title,location:a.address,id:a.id,callback:"cb"},l=oauthSignature.generate("GET",j,k,h,i);k.oauth_signature=l;var m={url:j,data:k,cache:!0,dataType:"jsonp",success:function(c){var d=c.rating,e=c.rating_img_url,f=c.image_url,g='<div class="col s12"> <h6 class="header">'+a.title+'</h6><img src="'+f+'" alt="destination-image"><p class="rtng">'+d+'stars</p> <img src="'+e+'" alt="destination-image"></div>';b.setContent(g)},error:function(){alert("Try again after some time")}};b.open(map,a),b.addListener("closeclick",function(){b.marker=null,null!==a.getAnimation()&&a.setAnimation(null)}),$.ajax(m)}var c=this;c.locationList=ko.observableArray([]),c.markers=ko.observableArray([]),locationList.forEach(function(a){c.locationList.push(new Locations(a))}),c.filter=ko.observable(""),c.filteredLocations=ko.computed(function(){var a=c.filter().toLowerCase();if(a){var b=ko.utils.arrayFilter(locationList,function(b){return b.title.toLowerCase().indexOf(a)>=0?(b.marker.setVisible(!0),b):void b.marker.setVisible(!1)});return b}return ko.utils.arrayFilter(locationList,function(a){a.marker&&a.marker.setVisible(!0)}),c.locationList()}),this.displayMarker=function(a){for(var c=a.title,d=locationList.length,e=null,f=0;f<d;f++)if(locationList[f].title==c){e=locationList[f].marker;break}null!=e&&b(e,largeInfowindow,!0)},c.init=a()};